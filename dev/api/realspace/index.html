<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Real space · Wannier.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Wannier.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../start/">Getting Started</a></li><li><span class="tocitem">Examples</span></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../../theory/algorithm/">Algorithm</a></li><li><a class="tocitem" href="../../theory/normalization/">Normalization</a></li><li><a class="tocitem" href="../../theory/initial_projection/">Initial projection</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../util/">Utility</a></li><li><a class="tocitem" href="../io/">Input/Output</a></li><li><a class="tocitem" href="../bvector/">B vector</a></li><li><a class="tocitem" href="../model/">Model</a></li><li><a class="tocitem" href="../wannierize/">Wannierize</a></li><li><a class="tocitem" href="../interpolation/">Interpolation</a></li><li class="is-active"><a class="tocitem" href>Real space</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Real-space-grid-struct"><span>Real-space grid struct</span></a></li><li><a class="tocitem" href="#Read/write-real-space-WFs"><span>Read/write real-space WFs</span></a></li><li><a class="tocitem" href="#Evaluate-operators-in-real-space"><span>Evaluate operators in real space</span></a></li></ul></li><li><a class="tocitem" href="../cli/">Command line</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>Real space</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Real space</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/qiaojunfeng/Wannier.jl/blob/main/docs/src/api/realspace.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Real-space-WFs"><a class="docs-heading-anchor" href="#Real-space-WFs">Real space WFs</a><a id="Real-space-WFs-1"></a><a class="docs-heading-anchor-permalink" href="#Real-space-WFs" title="Permalink"></a></h1><p>This page lists functions for processing WFs in real space.</p><p>Normally operators are computed in reciprocal space, but sometimes it might be useful to evaluate them in real space. For example, computing higher moment of WFs.</p><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="#Real-space-WFs">Real space WFs</a></li><li class="no-marker"><ul><li><a href="#Contents">Contents</a></li><li><a href="#Index">Index</a></li><li><a href="#Real-space-grid-struct">Real-space grid struct</a></li><li><a href="#Read/write-real-space-WFs">Read/write real-space WFs</a></li><li><a href="#Evaluate-operators-in-real-space">Evaluate operators in real space</a></li></ul></li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#Wannier.RGrid"><code>Wannier.RGrid</code></a></li><li><a href="#Wannier.RGrid-Tuple{AbstractMatrix, Vararg{AbstractVector, 4}}"><code>Wannier.RGrid</code></a></li><li><a href="#Wannier._get_unk_ext-Tuple{AbstractString}"><code>Wannier._get_unk_ext</code></a></li><li><a href="#Wannier.cartesianize_xyz-Tuple{Wannier.RGrid}"><code>Wannier.cartesianize_xyz</code></a></li><li><a href="#Wannier.center-Tuple{Wannier.RGrid, AbstractArray}"><code>Wannier.center</code></a></li><li><a href="#Wannier.moment-Union{Tuple{U}, Tuple{T}, Tuple{Wannier.RGrid, AbstractArray{T, 3}, U}} where {T&lt;:Complex, U&lt;:Integer}"><code>Wannier.moment</code></a></li><li><a href="#Wannier.omega-Tuple{Wannier.RGrid, AbstractArray}"><code>Wannier.omega</code></a></li><li><a href="#Wannier.origin-Tuple{Wannier.RGrid}"><code>Wannier.origin</code></a></li><li><a href="#Wannier.position_op-Union{Tuple{T}, Tuple{Wannier.RGrid, AbstractArray{T, 4}}} where T&lt;:Complex"><code>Wannier.position_op</code></a></li><li><a href="#Wannier.read_realspace_wf-Union{Tuple{T}, Tuple{AbstractMatrix{T}, Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}}, Tuple{AbstractMatrix{T}, Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}, Union{Int64, AbstractArray{Int64}}}, Tuple{AbstractMatrix{T}, Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}, Union{Int64, AbstractArray{Int64}}, AbstractString}} where T&lt;:Real"><code>Wannier.read_realspace_wf</code></a></li><li><a href="#Wannier.read_realspace_wf-Union{Tuple{T}, Tuple{Wannier.Model{T}, Array{Array{Complex{T}, 2}, 1}}, Tuple{Wannier.Model{T}, Array{Array{Complex{T}, 2}, 1}, Union{Int64, AbstractArray{Int64}}}, Tuple{Wannier.Model{T}, Array{Array{Complex{T}, 2}, 1}, Union{Int64, AbstractArray{Int64}}, AbstractString}} where T&lt;:Real"><code>Wannier.read_realspace_wf</code></a></li><li><a href="#Wannier.read_realspace_wf-Union{Tuple{Wannier.Model{T}}, Tuple{T}, Tuple{Wannier.Model{T}, Union{Int64, AbstractArray{Int64}}}, Tuple{Wannier.Model{T}, Union{Int64, AbstractArray{Int64}}, AbstractString}} where T&lt;:Real"><code>Wannier.read_realspace_wf</code></a></li><li><a href="#Wannier.read_realspace_wf-Union{Tuple{T}, Tuple{Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}, AbstractVector{Int64}, AbstractString}} where T&lt;:Real"><code>Wannier.read_realspace_wf</code></a></li><li><a href="#Wannier.span_vectors-Tuple{Wannier.RGrid}"><code>Wannier.span_vectors</code></a></li><li><a href="#Wannier.write_realspace_wf-Tuple{AbstractString, AbstractArray, Vector, AbstractMatrix, AbstractVector, AbstractVector{String}}"><code>Wannier.write_realspace_wf</code></a></li><li><a href="#Wannier.write_realspace_wf-Tuple{String, Wannier.Model}"><code>Wannier.write_realspace_wf</code></a></li></ul><h2 id="Real-space-grid-struct"><a class="docs-heading-anchor" href="#Real-space-grid-struct">Real-space grid struct</a><a id="Real-space-grid-struct-1"></a><a class="docs-heading-anchor-permalink" href="#Real-space-grid-struct" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Wannier.RGrid" href="#Wannier.RGrid"><code>Wannier.RGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct RGrid(basis, X, Y, Z)</code></pre><p>Represents a regular grid of points.</p><p><strong>Fields</strong></p><ul><li><code>basis</code>: each column is a basis vector of the grid,   usually just the lattice vectors.</li><li><code>X</code>: <code>nx * ny * nz</code> array of fractional coordinate w.r.t <code>basis</code>,   the x coordinate of each point in the grid.</li><li><code>Y</code>: <code>nx * ny * nz</code> array of fractional coordinate w.r.t <code>basis</code>,   the y coordinate of each point in the grid.</li><li><code>Z</code>: <code>nx * ny * nz</code> array of fractional coordinate w.r.t <code>basis</code>,   the z coordinate of each point in the grid.</li></ul><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>The <code>X</code>, <code>Y</code>, and <code>Z</code> are usually generated by <code>LazyGrids.ndgrid</code>. They are fractional and can be outside of <code>[0, 1)</code>, so the <code>basis</code> are not necessarily the spanning vectors of the grid. See also <a href="#Wannier.origin-Tuple{Wannier.RGrid}"><code>origin</code></a> and <a href="#Wannier.span_vectors-Tuple{Wannier.RGrid}"><code>span_vectors</code></a>.</p><p>Usually the grid does not contain the periodically repeated points, e.g., the x coordinate can be <code>[0.0, 0.25, 0.5, 0.75]</code> without <code>1.0</code> which is repeatition of <code>0.0</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/common/rgrid.jl#L3-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wannier.RGrid-Tuple{AbstractMatrix, Vararg{AbstractVector, 4}}" href="#Wannier.RGrid-Tuple{AbstractMatrix, Vararg{AbstractVector, 4}}"><code>Wannier.RGrid</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">RGrid(basis, origin, X, Y, Z)</code></pre><p>Construct a regular grid of points.</p><p><strong>Arguments</strong></p><ul><li><code>basis</code>: each column is a basis vector of the grid,   usually just the lattice vectors.</li><li><code>origin</code>: <code>3</code>, origin of the grid in cartesian coordinates</li><li><code>X</code>: <code>nx</code> vector of fractional coordinate w.r.t <code>basis</code>,   the x coordinate of each point in the grid.</li><li><code>Y</code>: <code>ny</code> vector of fractional coordinate w.r.t <code>basis</code>,   the y coordinate of each point in the grid.</li><li><code>Z</code>: <code>nz</code> vector of fractional coordinate w.r.t <code>basis</code>,   the z coordinate of each point in the grid.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/common/rgrid.jl#L49-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wannier.cartesianize_xyz-Tuple{Wannier.RGrid}" href="#Wannier.cartesianize_xyz-Tuple{Wannier.RGrid}"><code>Wannier.cartesianize_xyz</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cartesianize_xyz(rgrid::RGrid)</code></pre><p>Return <code>X</code>, <code>Y</code>, <code>Z</code> in cartesian coordinates.</p><p>The size of the returned <code>X</code>, <code>Y</code>, and <code>Z</code> are <code>nx * ny * nz</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/common/rgrid.jl#L123-L129">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wannier.origin-Tuple{Wannier.RGrid}" href="#Wannier.origin-Tuple{Wannier.RGrid}"><code>Wannier.origin</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">origin(rgrid::RGrid)</code></pre><p>Get the origin in cartesian coordinates, i.e. the 1st point, of the <code>RGrid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/common/rgrid.jl#L85-L89">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wannier.span_vectors-Tuple{Wannier.RGrid}" href="#Wannier.span_vectors-Tuple{Wannier.RGrid}"><code>Wannier.span_vectors</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">span_vectors(rgrid::RGrid)</code></pre><p>Get the spanning vectors of the <code>RGrid</code>.</p><p>Each column in the returned matrix is a spanning vector.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>There is no limit constraint on the fractional coordinates <code>X</code>, <code>Y</code>, and <code>Z</code>, so the spanning vectors are not necessarily the basis vectors, they can be fractional of the basis vectors, or multiple times of that.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/common/rgrid.jl#L96-L108">source</a></section></article><h2 id="Read/write-real-space-WFs"><a class="docs-heading-anchor" href="#Read/write-real-space-WFs">Read/write real-space WFs</a><a id="Read/write-real-space-WFs-1"></a><a class="docs-heading-anchor-permalink" href="#Read/write-real-space-WFs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Wannier._get_unk_ext-Tuple{AbstractString}" href="#Wannier._get_unk_ext-Tuple{AbstractString}"><code>Wannier._get_unk_ext</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_get_unk_ext(unkdir::AbstractString)</code></pre><p>Get the extension name of <code>UNK</code> files.</p><p>For example:</p><ul><li><code>1</code> of <code>UNK00001.1</code>, for no-spin calcluation</li><li><code>NC</code> of <code>UNK00001.NC</code>, for non-collinear calculation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/realspace/wavefunction.jl#L6-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wannier.read_realspace_wf-Union{Tuple{T}, Tuple{AbstractMatrix{T}, Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}}, Tuple{AbstractMatrix{T}, Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}, Union{Int64, AbstractArray{Int64}}}, Tuple{AbstractMatrix{T}, Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}, Union{Int64, AbstractArray{Int64}}, AbstractString}} where T&lt;:Real" href="#Wannier.read_realspace_wf-Union{Tuple{T}, Tuple{AbstractMatrix{T}, Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}}, Tuple{AbstractMatrix{T}, Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}, Union{Int64, AbstractArray{Int64}}}, Tuple{AbstractMatrix{T}, Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}, Union{Int64, AbstractArray{Int64}}, AbstractString}} where T&lt;:Real"><code>Wannier.read_realspace_wf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_realspace_wf(lattice, U, kpoints, n_supercells=2, unkdir=&quot;.&quot;; R=[0, 0, 0])</code></pre><p>Read <code>UNK</code> files, rotate gauge, and generate real space WFs.</p><p>This is a more user-friendly version, which returns a tuple of <code>(RGrid, W)</code>, where <code>RGrid</code> is the grid on which <code>W</code> is defined, and <code>W</code> is volumetric data for WFs.</p><p><strong>Arguments</strong></p><ul><li><code>lattice</code>: each column is a lattice vector</li><li><code>U</code>: <code>n_bands * n_wann * n_kpts</code>, gauge rotation matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/realspace/wavefunction.jl#L153-L164">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wannier.read_realspace_wf-Union{Tuple{T}, Tuple{Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}, AbstractVector{Int64}, AbstractString}} where T&lt;:Real" href="#Wannier.read_realspace_wf-Union{Tuple{T}, Tuple{Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}, AbstractVector{Int64}, AbstractString}} where T&lt;:Real"><code>Wannier.read_realspace_wf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_realspace_wf(U, kpoints, n_supercells, unkdir=&quot;.&quot;; R=[0, 0, 0])</code></pre><p>Read <code>UNK</code> files, rotate gauge, and generate real space WFs.</p><p><strong>Arguments</strong></p><ul><li><code>U</code>: <code>n_bands * n_wann * n_kpts</code>, gauge rotation matrix</li><li><code>kpoints</code>: <code>3 * n_kpts</code>, each column is a vector for fractional coordinates</li><li><code>n_supercells</code>: an integer or a vector of 3 integers for 3 directions along lattice vectors,   defines the number of super cells where the real space WF lives</li><li><code>unkdir</code>: folder containing <code>UNK</code> files</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>R</code>: fractional coordinates w.r.t lattice (actually integers), the cell for WF   <span>$|n \bm{R} \rangle$</span>, default is generating WF at home unit cell <span>$|n \bm{0} \rangle$</span></li></ul><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>See also the section <a href="../../theory/normalization/#Normalization-convention-of-WFs">Normalization convention of WFs</a> for further explanation.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/realspace/wavefunction.jl#L23-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wannier.read_realspace_wf-Union{Tuple{T}, Tuple{Wannier.Model{T}, Array{Array{Complex{T}, 2}, 1}}, Tuple{Wannier.Model{T}, Array{Array{Complex{T}, 2}, 1}, Union{Int64, AbstractArray{Int64}}}, Tuple{Wannier.Model{T}, Array{Array{Complex{T}, 2}, 1}, Union{Int64, AbstractArray{Int64}}, AbstractString}} where T&lt;:Real" href="#Wannier.read_realspace_wf-Union{Tuple{T}, Tuple{Wannier.Model{T}, Array{Array{Complex{T}, 2}, 1}}, Tuple{Wannier.Model{T}, Array{Array{Complex{T}, 2}, 1}, Union{Int64, AbstractArray{Int64}}}, Tuple{Wannier.Model{T}, Array{Array{Complex{T}, 2}, 1}, Union{Int64, AbstractArray{Int64}}, AbstractString}} where T&lt;:Real"><code>Wannier.read_realspace_wf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_realspace_wf(model, U, n_supercells=2, unkdir=&quot;.&quot;; R=[0, 0, 0])</code></pre><p>Read <code>UNK</code> files, rotate gauge, and generate real space WFs.</p><p>This is a most user-friendly version, use <code>lattice</code>, <code>U</code> and <code>kpoints</code> from <code>model</code> and returns a tuple of <code>(RGrid, W)</code>, where <code>RGrid</code> is the grid on which <code>W</code> is defined, and <code>W</code> is volumetric data for WFs.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: a <code>Model</code></li><li><code>U</code>: <code>n_bands * n_wann * n_kpts</code>, gauge rotation matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/realspace/wavefunction.jl#L178-L190">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wannier.read_realspace_wf-Union{Tuple{Wannier.Model{T}}, Tuple{T}, Tuple{Wannier.Model{T}, Union{Int64, AbstractArray{Int64}}}, Tuple{Wannier.Model{T}, Union{Int64, AbstractArray{Int64}}, AbstractString}} where T&lt;:Real" href="#Wannier.read_realspace_wf-Union{Tuple{Wannier.Model{T}}, Tuple{T}, Tuple{Wannier.Model{T}, Union{Int64, AbstractArray{Int64}}}, Tuple{Wannier.Model{T}, Union{Int64, AbstractArray{Int64}}, AbstractString}} where T&lt;:Real"><code>Wannier.read_realspace_wf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_realspace_wf(model, n_supercells=2, unkdir=&quot;.&quot;; R=[0, 0, 0])</code></pre><p>Read <code>UNK</code> files, rotate gauge, and generate real space WFs.</p><p>This is a most user-friendly version, use <code>lattice</code>, <code>U</code> and <code>kpoints</code> from <code>model</code> and returns a tuple of <code>(RGrid, W)</code>, where <code>RGrid</code> is the grid on which <code>W</code> is defined, and <code>W</code> is volumetric data for WFs.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: a <code>Model</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/realspace/wavefunction.jl#L201-L212">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wannier.write_realspace_wf-Tuple{AbstractString, AbstractArray, Vector, AbstractMatrix, AbstractVector, AbstractVector{String}}" href="#Wannier.write_realspace_wf-Tuple{AbstractString, AbstractArray, Vector, AbstractMatrix, AbstractVector, AbstractVector{String}}"><code>Wannier.write_realspace_wf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_realspace_wf(seedname, U, kpoints, lattice, atom_positions, atom_labels;
    n_supercells=2, unkdir=&quot;.&quot;, part=real, format=:xsf, wf_center=nothing)</code></pre><p>Write real space WFs to <code>xsf</code> or <code>cube</code> files.</p><p><strong>Arguments</strong></p><ul><li><code>seedname</code>: the name prefix for <code>cube</code> files, e.g., <code>seedname_00001.cube</code></li><li><code>U</code>: gauge rotation matrix</li><li><code>kpoints</code>: each column is a kpoint, fractional coordinates</li><li><code>lattice</code>: each column is a lattice vector</li><li><code>atom_positions</code>: each column is an atom position, fractional coordinates w.r.t. lattice</li><li><code>atom_labels</code>: each element is an atom label</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>n_supercells</code>: number of supercells in each direction,   equivalent to <code>wannier_plot_supercell</code> of <code>Wannier90</code></li><li><code>unkdir</code>: directory of <code>UNK</code> files</li><li><code>part</code>: which part to plot? pass a <code>Function</code>, e.g. <code>real</code>, <code>imag</code>, <code>abs2</code></li><li><code>format</code>: <code>:xsf</code> or <code>:cube</code></li><li><code>wf_center</code>: WF centers in fractional coordinates w.r.t. lattice.   Only used for <code>cube</code> format, add additional atoms around WF centers.</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>Wannier90</code> only plot the real part of WFs, so <code>part=real</code> is the default.</p></div></div><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>See also the section <a href="../../theory/normalization/#Normalization-convention-of-WFs">Normalization convention of WFs</a> for further explanation.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/realspace/wavefunction.jl#L222-L252">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wannier.write_realspace_wf-Tuple{String, Wannier.Model}" href="#Wannier.write_realspace_wf-Tuple{String, Wannier.Model}"><code>Wannier.write_realspace_wf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_realspace_wf(seedname, model; n_supercells=2, unkdir=&quot;.&quot;, part=real, format=:xsf)</code></pre><p>Write real space WFs to <code>xsf</code> or <code>cube</code> files.</p><p>This is a user-friendly version that use <code>model</code> to fill the arguments of <code>write_realspace_wf</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/realspace/wavefunction.jl#L325-L331">source</a></section></article><h2 id="Evaluate-operators-in-real-space"><a class="docs-heading-anchor" href="#Evaluate-operators-in-real-space">Evaluate operators in real space</a><a id="Evaluate-operators-in-real-space-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluate-operators-in-real-space" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Wannier.center-Tuple{Wannier.RGrid, AbstractArray}" href="#Wannier.center-Tuple{Wannier.RGrid, AbstractArray}"><code>Wannier.center</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">center(rgrid::RGrid, W::AbstractArray)</code></pre><p>Compute WF center in real space.</p><p>Returned value in Cartesian coordinates.</p><p>See also <a href="#Wannier.moment-Union{Tuple{U}, Tuple{T}, Tuple{Wannier.RGrid, AbstractArray{T, 3}, U}} where {T&lt;:Complex, U&lt;:Integer}"><code>moment</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/realspace/moment.jl#L42-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wannier.moment-Union{Tuple{U}, Tuple{T}, Tuple{Wannier.RGrid, AbstractArray{T, 3}, U}} where {T&lt;:Complex, U&lt;:Integer}" href="#Wannier.moment-Union{Tuple{U}, Tuple{T}, Tuple{Wannier.RGrid, AbstractArray{T, 3}, U}} where {T&lt;:Complex, U&lt;:Integer}"><code>Wannier.moment</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">moment(rgrid::RGrid, W::AbstractArray, n)</code></pre><p>Compute WF moment to arbitrary order in real space.</p><p><strong>Arguments</strong></p><ul><li><code>rgrid</code>: real space grid on which <code>W</code> is defined</li><li><code>W</code>: WFs, <code>nx * ny * nz * n_wann</code>, or <code>nx * ny * nz</code> for single WF</li><li><code>n</code>: order of moment, e.g., 1 for WF center, 2 for variance, etc.</li></ul><p>Returned value in Cartesian coordinates.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The WFs are defined in a supercell that is <code>n_kpts</code> times unit cell, however, usually we only calculate realspace WFs in a smaller supercell that is 2^3 or 3^3 times unit cell (as defined by the <code>n_supercells</code> argument of <a href="#Wannier.read_realspace_wf-Union{Tuple{T}, Tuple{AbstractMatrix{T}, Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}}, Tuple{AbstractMatrix{T}, Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}, Union{Int64, AbstractArray{Int64}}}, Tuple{AbstractMatrix{T}, Array{Array{Complex{T}, 2}, 1}, Array{StaticArraysCore.SVector{3, T}, 1}, Union{Int64, AbstractArray{Int64}}, AbstractString}} where T&lt;:Real"><code>read_realspace_wf</code></a>). Some times this is not sufficient if the WFs are truncated by the boundries of the smaller supercell, thus the center calculated by this function is inexact. In principle, we should calculate centers in the <code>n_kpts</code> supercell, however, this is memory-consuming.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/realspace/moment.jl#L3-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wannier.omega-Tuple{Wannier.RGrid, AbstractArray}" href="#Wannier.omega-Tuple{Wannier.RGrid, AbstractArray}"><code>Wannier.omega</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">omega(rgrid::RGrid, W::AbstractArray)</code></pre><p>Compute WF spread in real space.</p><p>Returned value in Å^2 unit.</p><p>See also <a href="#Wannier.moment-Union{Tuple{U}, Tuple{T}, Tuple{Wannier.RGrid, AbstractArray{T, 3}, U}} where {T&lt;:Complex, U&lt;:Integer}"><code>moment</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/realspace/moment.jl#L53-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wannier.position_op-Union{Tuple{T}, Tuple{Wannier.RGrid, AbstractArray{T, 4}}} where T&lt;:Complex" href="#Wannier.position_op-Union{Tuple{T}, Tuple{Wannier.RGrid, AbstractArray{T, 4}}} where T&lt;:Complex"><code>Wannier.position_op</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">position_op(rgrid::RGrid, W::AbstractArray{T,4})</code></pre><p>Compute position operator matrices in real space.</p><p>Returned value in Cartesian coordinates.</p><p>See also <a href="../model/#Wannier.center-Tuple{Wannier.BVectors, Any, Any}"><code>center</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/qiaojunfeng/Wannier.jl/blob/764f27096e3408234bdd1f076356c95ea9621903/src/realspace/moment.jl#L66-L74">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../interpolation/">« Interpolation</a><a class="docs-footer-nextpage" href="../cli/">Command line »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 27 July 2023 21:55">Thursday 27 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
